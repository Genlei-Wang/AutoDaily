# 云端自动编译使用指南

## 方案一：GitHub Actions 自动编译（推荐）

### 优势
- ✅ 无需本地 Windows 环境
- ✅ 自动编译，每次推送代码自动生成
- ✅ 编译产物自动保存 30 天
- ✅ 完全免费（GitHub 提供）

### 使用步骤

#### 1. 上传代码到 GitHub

```bash
# 在 Mac 上
cd /Users/yingdao/Documents/Project/日报通

# 初始化 Git（如果还没有）
git init
git add .
git commit -m "Initial commit"

# 添加远程仓库
git remote add origin https://github.com/YOUR_USERNAME/REPO_NAME.git
git branch -M main
git push -u origin main
```

#### 2. 启用 GitHub Actions

1. 登录 GitHub，进入你的仓库
2. 点击 `Actions` 标签
3. 如果提示启用 Actions，点击 `I understand my workflows, enable them`
4. 工作流文件已创建在 `.github/workflows/build.yml`

#### 3. 触发编译

**自动触发**：
- 每次 `git push` 到 main 分支
- 创建 Pull Request

**手动触发**：
1. 进入仓库的 `Actions` 页面
2. 选择 `Build AutoDaily` 工作流
3. 点击 `Run workflow` → `Run workflow`

#### 4. 下载编译结果

1. 编译完成后，进入 `Actions` 页面
2. 点击最新的运行记录
3. 在 `Artifacts` 部分下载 `AutoDaily-Release.zip`
4. 解压后即可使用

### 工作流说明

GitHub Actions 会自动：
1. 在 Windows 服务器上检出代码
2. 安装 .NET Framework 和 MSBuild
3. 编译 Release 版本
4. 打包为 ZIP 文件
5. 保存为 Artifact（30 天）

## 方案二：本地 Windows 编译 + 打包脚本

### 使用步骤

#### 1. 在 Windows 电脑上

```powershell
# 克隆仓库
git clone https://github.com/YOUR_USERNAME/REPO_NAME.git
cd REPO_NAME

# 运行打包脚本
cd scripts
.\create-installer.ps1
```

#### 2. 脚本会自动

- 清理旧文件
- 编译 Release 版本
- 创建发布目录
- 打包为 ZIP 文件
- 生成使用说明

#### 3. 输出位置

- 文件夹：`dist\AutoDaily-v1.0.0\`
- 压缩包：`dist\AutoDaily-v1.0.0.zip`

## 方案三：使用 GitHub Releases（推荐用于正式发布）

### 创建 Release

1. 在 GitHub 仓库页面，点击 `Releases`
2. 点击 `Create a new release`
3. 填写版本号（如 `v1.0.0`）
4. 上传编译好的 ZIP 文件
5. 添加发布说明

### 用户下载

用户可以直接从 Releases 页面下载最新版本，无需访问 Actions。

## 推荐工作流程

### 日常开发

```bash
# Mac 上开发
git add .
git commit -m "修复xxx问题"
git push

# GitHub Actions 自动编译
# 在 Actions 页面下载编译结果
```

### 正式发布

```bash
# 1. 在 Mac 上打标签
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0

# 2. 在 GitHub 上创建 Release
# 3. 上传编译好的文件
```

## 常见问题

### Q: GitHub Actions 编译失败？

**A:** 检查：
1. 工作流文件 `.github/workflows/build.yml` 是否存在
2. 代码是否有语法错误
3. Actions 页面查看详细错误信息

### Q: 如何修改版本号？

**A:** 
- GitHub Actions：自动使用时间戳
- 本地脚本：修改 `create-installer.ps1` 中的 `$Version` 参数

### Q: 编译产物在哪里？

**A:**
- GitHub Actions：`Actions` → 选择运行 → `Artifacts`
- 本地脚本：`dist\AutoDaily-v1.0.0.zip`

### Q: 可以自动创建 Release 吗？

**A:** 可以！修改 `.github/workflows/build.yml`，添加 Release 创建步骤（需要 GitHub Token）。

## 高级：自动创建 Release

如果需要自动创建 GitHub Release，可以修改工作流文件添加以下步骤：

```yaml
- name: Create Release
  uses: softprops/action-gh-release@v1
  with:
    files: release/*.zip
    tag_name: v${{ github.run_number }}
    name: Release v${{ github.run_number }}
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

这样每次编译成功会自动创建 Release。

