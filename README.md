# AutoDaily 日报助手

一个轻量级、易用的 Windows 桌面自动化工具，专为银行、保险等国央企、公司职员设计，用于简化每日重复的日报流程。

## ✨ 功能特性

### 核心功能
- 🎬 **智能录制**：录制鼠标点击、键盘输入（支持所有字符、符号）、鼠标滚轮、鼠标移动等操作
- ▶️ **自动执行**：精确回放录制的动作序列，支持相对坐标和窗口位置记忆
- ⏰ **定时运行**：支持每天定时自动执行，智能调度算法（减少资源消耗）
- 🎨 **简洁界面**：400x600 精致窗口，参考 Apple 设计规范，清晰易读
- 🛡️ **安全可靠**：运行时遮罩层提示，F10 紧急停止

### 高级特性
- 📝 **完整键盘支持**：支持字母、数字、符号、Win 键、快捷键组合等
- 🖱️ **精确坐标**：记录窗口位置，支持窗口移动后的坐标计算
- 📊 **进度显示**：实时显示执行进度和当前动作类型
- 💾 **数据本地化**：数据存储在 exe 同目录，便于备份和迁移
- 🔔 **智能提醒**：定时运行开启后提示保持软件运行

## 🖥️ 技术规格

- **平台**: Windows 7/10/11 (x86/x64)
- **框架**: .NET Framework 4.7.2
- **UI**: WinForms
- **体积**: < 2MB (零第三方依赖)
- **DPI 支持**: 自动适配 150%、200% 等系统缩放

## 📦 项目结构

```
AutoDaily/
├── Core/
│   ├── Models/          # 数据模型（Task, WindowInfo, Action等）
│   ├── Services/        # 业务服务（TaskService, ScheduleService, LogService）
│   ├── Native/          # Win32 API封装（User32, Kernel32）
│   └── Engine/          # 录制和执行引擎（Recorder, Player）
├── UI/
│   ├── Forms/           # 窗体（MainForm, OverlayForm, RunningOverlayForm）
│   └── Controls/        # 自定义控件（ToggleSwitch）
├── Program.cs           # 入口点
└── AutoDaily.csproj     # 项目文件
```

## 🚀 快速开始

### 编译说明

1. 使用 Visual Studio 2017 或更高版本打开 `AutoDaily.sln`
2. 确保已安装 .NET Framework 4.7.2 开发工具
3. 编译项目（Release 模式）
4. 输出文件位于 `AutoDaily/bin/Release/AutoDaily.exe`

### 使用说明

#### 录制动作

1. 点击"🔴 录制"按钮
2. 主窗口会自动最小化，开始操作目标应用程序（点击、输入、滚动等）
3. 操作完成后，按 F10 或点击任务栏图标停止录制

**支持录制的操作：**
- 鼠标左键/右键点击
- 鼠标移动（轨迹记录）
- 鼠标滚轮
- 键盘输入（字母、数字、符号）
- 快捷键组合（Ctrl+C, Ctrl+V 等）
- 特殊键（Enter, Tab, Escape, Win 键等）

#### 运行任务

1. 点击"▶️ 运行"按钮
2. 主窗口会自动隐藏，显示进度弹窗
3. 软件会自动执行录制的动作序列
4. 如需停止，按 **F10** 键或点击弹窗关闭按钮

#### 定时运行

1. 开启"定时运行"开关
2. 设置定时时间（如 09:00，仅显示时:分）
3. 软件会在每天指定时间自动执行（最多延迟 30 秒）
4. **重要提示**：请保持软件运行，不要关闭或让电脑睡眠

**定时运行特性：**
- 智能调度：根据距离目标时间的远近动态调整检查间隔（减少资源消耗）
- 精确触发：接近目标时间时每秒检查，确保准时执行
- 防重复：自动防止同一天重复执行

## 💾 数据存储

### 存储位置
- **任务数据**: `{exe目录}\Data\tasks.json`
- **日志文件**: `{exe目录}\Data\Logs\AutoDaily_{日期}.log`

### 数据格式
任务数据以 JSON 格式存储，包含：
- 录制的动作序列（类型、坐标、参数等）
- 目标窗口信息（标题、进程名、位置、大小）
- 定时运行配置（是否启用、时间、最后运行时间）

## 🎨 界面设计

### 主窗口
- **尺寸**: 400px × 600px（支持 DPI 自动缩放）
- **布局**: 居中设计，左右各 30px 边距
- **字体**: 统一使用微软雅黑，遵循 Apple 设计规范
  - 标题：16pt
  - 按钮：14pt
  - 标签：12pt
  - 提示：11pt（最小字号）

### 运行弹窗
- **尺寸**: 280px × 120px
- **位置**: 屏幕右上角
- **功能**: 显示执行进度、当前动作、停止提示

## ⚙️ 配置说明

### 热键
- **F10**: 停止运行（全局热键，运行时有效）

### 定时运行
- **检查间隔**: 智能调度
  - 距离目标时间 > 5 分钟：每 60 秒检查
  - 距离目标时间 1-5 分钟：每 10 秒检查
  - 距离目标时间 < 1 分钟：每 1 秒检查（精确触发）
- **触发窗口**: 目标时间前后 30 秒
- **防重复**: 同一天只执行一次

## 📝 注意事项

- 录制时请确保目标窗口处于活动状态
- 运行时会自动调整目标窗口大小以匹配录制时的尺寸
- 支持多显示器环境
- 建议在运行前关闭其他可能干扰的应用程序
- 首次运行 exe 可能显示 Windows SmartScreen 警告（未签名），可选择"仍要运行"
- 定时运行需要软件保持运行状态，关闭软件将无法执行定时任务

## 🔧 开发计划

- [x] V1.0: 基础录制和回放功能
- [x] V1.0.1: 完整键盘支持、定时运行、界面优化
- [ ] V1.x: 支持多任务
- [ ] V2.0: 增加条件判断和图像识别

## 📄 许可证

本项目采用 MIT 许可证。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📧 联系方式

如有问题或建议，请通过 GitHub Issues 反馈。

---

**版本**: 1.0.1  
**最后更新**: 2024年12月
